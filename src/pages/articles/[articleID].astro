---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from "astro:content";
import { generateArticalIdentity } from '../../scripts/ArticleIdentityGenerator.js';

export async function getStaticPaths() {
    const articles = await getCollection('news');
    return articles.map(({data}) => ({
        params: { articleID: generateArticalIdentity(data.title, data.date, data.author) }, // d.data.title, d.data.date, d.data.author  'my title', '3/30/2024', 'web' generateArticalIdentity()
    }));    
}



const { articleID } = Astro.params;
const article = await getCollection('news', ({ data }) => generateArticalIdentity(data.title, data.date, data.author) === articleID);

if (!article) {
    throw new Error(`No article found for ArticleID: ${articleID}`);
}

const articleObj = article[0];
---

<BaseLayout title = {articleObj.data.title}>
        <article>
            <h1>{articleObj.data.title}</h1>
            <p>{articleObj.data.date}</p>
            <p>{articleObj.body}</p>
        </article>
</BaseLayout>